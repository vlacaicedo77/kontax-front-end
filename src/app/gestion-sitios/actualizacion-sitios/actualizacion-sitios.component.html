<hr class="mt-0">
<div class='row'>
    <div class='col-12'>
        <div class='card'>
            <div class="card-header bg-info text-white rounded-top">
                Consultar datos del predio
            </div>
            <hr class="mt-0">
            <div class="card-body">
                <h4 class="card-title">Seleccione el predio que desea actualizar<b>(predios pendientes y activos)</b></h4>
                <form ngNativeValidate [formGroup]="formularioPredio" class="form-horizontal r-separator" (ngSubmit)="buscarDetallesSitio()" action="index.html">
                    <div class="form-group row align-items-center mb-0">
                        <label for="inputSitio" class="col-md-3 text-right control-label col-form-label">Predio</label>
                        <div class="col-md-9 border-left pb-2 pt-2 input-group">
                            <select class="form-control" formControlName="inputSitio">
                                <option value=null selected disabled>Seleccione una opción</option>
                                <ng-container *ngFor="let sitio of listaSitios">
                                    <option  value="{{sitio.idSitio}}">{{sitio.nombre}} ({{sitio.codigoSitio}})</option>
                                </ng-container>
                            </select>
                            <div class="input-group-append">
                                <button class="btn btn-success" type="submit"><i class="ti-search"></i></button>
                            </div>
                            <div class="invalid-feedback d-block" *ngIf="formularioPredio.controls.inputSitio.errors?.required && formularioPredio.touched">
                                Seleccione un predio
                            </div>
                        </div>
                    </div>
                </form>
            </div>
            <ng-container *ngIf="this.detalleVisible">
            <div class="card-header bg-info text-white rounded-top">
                Detalle del predio
            </div>
            <hr class="mt-0">
            <form class="form-horizontal r-separator" ngNativeValidate [formGroup]="formulario" (ngSubmit)="actualizarSitio()" class="form-horizontal r-separator" action="index.html">
                <div class="card-body">
                    <h4 class="card-title">Información del predio</h4>
                    <div class="form-group row align-items-center mb-0">
                        <label for="inputNombre" class="col-md-3 text-right control-label col-form-label">Nombre del predio</label>
                        <div class="col-md-9 border-left pb-2 pt-2">
                            <input type="text" class="form-control" (keyup)="mascara($event,'alfanumerico')" formControlName="inputNombre" name="inputNombre" placeholder="Ingrese el nombre del predio">
                            <input type="hidden" class="form-control" formControlName="inputIdSitio" name="inputIdSitio">
                            <div class="invalid-feedback d-block" *ngIf="formulario.controls.inputNombre.errors?.required && formulario.touched">
                                Ingrese el nombre del predio
                            </div>
                        </div>
                    </div>
                    <div class="form-group row align-items-center mb-0">
                        <label for="inputSuperficieHa" class="col-md-3 text-right control-label col-form-label">Superficie total (Ha)</label>
                        <div class="col-md-9 border-left pb-2 pt-2">
                            <input type="text" class="form-control" (keyup)="mascara($event,'decimal')" formControlName="inputSuperficieHa" name="inputSuperficieHa" placeholder="Ingrese la superficie de la finca en hectáreas">
                            <div class="invalid-feedback d-block" *ngIf="formulario.controls.inputSuperficieHa.errors?.required && formulario.touched">
                                Ingrese la superficie del predio en hectáreas
                            </div>
                        </div>
                    </div>
                    <div class="form-group row align-items-center mb-0">
                        <label for="inputCodigoPredial" class="col-md-3 text-right control-label col-form-label">Código predial</label>
                        <div class="col-md-9 border-left pb-2 pt-2">
                            <input type="text" class="form-control" (keyup)="mascara($event,'alfanumerico')" formControlName="inputCodigoPredial" name="inputCodigoPredial" placeholder="Ingrese el código predial de la finca">
                            <div class="invalid-feedback d-block" *ngIf="formulario.controls.inputCodigoPredial.errors?.required && formulario.touched">
                                Ingrese el código predial asignado por la autoridad local
                            </div>
                        </div>
                    </div>
                    <div class="form-group row align-items-center mb-0">
                        <label for="inputTipoPropiedad" class="col-md-3 text-right control-label col-form-label">Predio propio o alquilado</label>
                        <div class="col-md-9 border-left pb-2 pt-2">
                            <select class="form-control" formControlName="inputTipoPropiedad" name="inputTipoPropiedad">
                                <option value=null selected disabled>Seleccione una opción</option>
                                <option *ngFor="let tipoPropiedad of listaTiposPropiedad" value="{{tipoPropiedad.id_tipo_propiedad}}">{{tipoPropiedad.nombre}}</option>
                            </select>
                            <div class="invalid-feedback d-block" *ngIf="formulario.controls.inputTipoPropiedad.errors?.required && formulario.touched">
                                Seleccione el tipo de contrato de propiedad
                            </div>
                        </div>
                    </div>
                    <div class="form-group row align-items-center mb-0">
                        <label class="col-md-3 text-right control-label col-form-label">Documento de propiedad o arriendo actual</label>
                        <div class="form-group mb-0 text-left col-md-9">
                            <button type="button" (click)="descargarDocumentoSitio(sitio.url_documento_propiedad, sitio.codigo_sitio)" class="btn btn-info waves-effect waves-light col-md-3">Descargar</button>
                        </div>
                    </div>
                    <div class="form-group row align-items-center mb-0">
                        <label for="documentoPropiedad" class="col-md-3 text-right control-label col-form-label">Documento de propiedad o de arriendo:</label>
                        <div class="col-md-9 border-left pb-2 pt-2">
                            <input type="file" class="file" data-browse-on-zone-click="true" name="documentoPropiedad" formControlName="documentoPropiedad" (change)="seleccionarArchivoPropiedad($event)" />
                        </div>
                    </div>
                    <div class="form-group row align-items-center mb-0">
                        <label for="inputTipoTelefono" class="col-md-3 text-right control-label col-form-label">Tipo de teléfono</label>
                        <div class="col-md-9 border-left pb-2 pt-2">
                            <input type="radio" value="fijo" name="inputTipoTelefono" formControlName="inputTipoTelefono" (change)="cambiarMascaraTelefono()" > Fijo
                            <input type="radio" value="movil" name="inputTipoTelefono" formControlName="inputTipoTelefono" (change)="cambiarMascaraTelefono()" > Celular
                            <div class="invalid-feedback d-block" *ngIf="formulario.controls.inputTipoTelefono.errors?.required && formulario.touched">
                                Seleccione el tipo de teléfono
                            </div>
                        </div>
                    </div>
                    <div class="form-group row align-items-center mb-0">
                        <label for="inputTelefono" class="col-md-3 text-right control-label col-form-label">Teléfono de contacto</label>
                        <div class="col-md-9 border-left pb-2 pt-2">
                            <input type="text" class="form-control" (keyup)="mascara($event,mascaraTelefono)" formControlName="inputTelefono" name="inputTelefono" placeholder="Ingrese el teléfono incluyendo el código provincial (03)22342234">
                            <div class="invalid-feedback d-block" *ngIf="formulario.controls.inputTelefono.errors?.required && formulario.touched">
                                Ingrese el teléfono incluyendo el código provincial (03)22342234
                            </div>
                        </div>
                    </div>
                </div>
                <div class="card-body">
                    <h4 class="card-title">Datos de ubicación</h4>
                    <div class="form-group row align-items-center mb-0">
                        <label class="col-md-3 text-right control-label col-form-label">País</label>
                        <div class="col-md-9 border-left pb-2 pt-2">
                            <label class="col-md-5 text-left control-label col-form-label">{{sitio.pais}}</label>
                        </div>
                    </div>
                    <div class="form-group row align-items-center mb-0">
                        <label class="col-md-3 text-right control-label col-form-label">Provincia</label>
                        <div class="col-md-9 border-left pb-2 pt-2">
                            <label class="col-md-5 text-left control-label col-form-label">{{sitio.provincia}}</label>
                        </div>
                    </div>
                    <div class="form-group row align-items-center mb-0">
                        <label class="col-md-3 text-right control-label col-form-label">Cantón</label>
                        <div class="col-md-9 border-left pb-2 pt-2">
                            <label class="col-md-5 text-left control-label col-form-label">{{sitio.canton}}</label>
                        </div>
                    </div>
                    <div class="form-group row align-items-center mb-0">
                        <label class="col-md-3 text-right control-label col-form-label">Parroquia</label>
                        <div class="col-md-9 border-left pb-2 pt-2">
                            <label class="col-md-5 text-left control-label col-form-label">{{sitio.parroquia}}</label>
                        </div>
                    </div>
                    <div class="form-group row align-items-center mb-0">
                        <label for="inputCallePrincipal" class="col-md-3 text-right control-label col-form-label">Calle principal</label>
                        <div class="col-md-9 border-left pb-2 pt-2">
                            <input type="text" class="form-control" (keyup)="mascara($event,'alfanumerico')" formControlName="inputCallePrincipal" name="inputCallePrincipal" placeholder="Ingrese la calle principal">
                            <div class="invalid-feedback d-block" *ngIf="formulario.controls.inputCallePrincipal.errors?.required && formulario.touched">
                                Ingrese la calle principal
                            </div>
                        </div>
                    </div>
                    <div class="form-group row align-items-center mb-0">
                        <label for="inputInterseccion" class="col-md-3 text-right control-label col-form-label">Intersección</label>
                        <div class="col-md-9 border-left pb-2 pt-2">
                            <input type="text" class="form-control" (keyup)="mascara($event,'alfanumerico')" formControlName="inputInterseccion" name="inputInterseccion" placeholder="Ingrese la intersección">
                            <!--div class="invalid-feedback d-block" *ngIf="formulario.controls.inputInterseccion.errors?.required && formulario.touched">
                                Ingrese la intersección
                            </div-->    
                        </div>
                    </div>
                    <div class="form-group row align-items-center mb-0">
                        <label for="inputNumeracion" class="col-md-3 text-right control-label col-form-label">Numeración</label>
                        <div class="col-md-9 border-left pb-2 pt-2">
                            <input type="text" class="form-control" (keyup)="mascara($event,'alfanumerico')" formControlName="inputNumeracion" name="inputNumeracion" placeholder="Ingrese la numeración">
                            <!--div class="invalid-feedback d-block" *ngIf="formulario.controls.inputNumeracion.errors?.required && formulario.touched">
                                Ingrese la numeración del predio
                            </div-->
                        </div>
                    </div>
                    <div class="form-group row align-items-center mb-0">
                        <label for="inputReferencia" class="col-md-3 text-right control-label col-form-label">Referencia</label>
                        <div class="col-md-9 border-left pb-2 pt-2">
                            <input type="text" class="form-control" (keyup)="mascara($event,'alfanumerico')" formControlName="inputReferencia" name="inputReferencia" placeholder="Ingrese una referencia">
                            <div class="invalid-feedback d-block" *ngIf="formulario.controls.inputReferencia.errors?.required && formulario.touched">
                                Ingrese una referencia de la ubicación del predio
                            </div>
                        </div>
                    </div>
                    <div class="form-group row align-items-center mb-0">
                        <label for="inputLatitud" class="col-md-3 text-right control-label col-form-label">Latitud</label>
                        <div class="col-md-9 border-left pb-2 pt-2">
                            <input type="text" class="form-control" name="inputLatitudVisible" placeholder="Seleccione un punto en el mapa" readonly value="{{latitudMarcador}}">
                            <input type="hidden" class="form-control" formControlName="inputLatitud" name="inputLatitud" value="{{latitudMarcador}}">
                            <div class="invalid-feedback d-block" *ngIf="formulario.controls.inputLatitud.errors?.required && formulario.touched">
                                Seleccione en el mapa la ubicación del predio
                            </div>
                        </div>
                    </div>
                    <div class="form-group row align-items-center mb-0">
                        <label for="inputLongitud" class="col-md-3 text-right control-label col-form-label">Longitud</label>
                        <div class="col-md-9 border-left pb-2 pt-2">
                            <input type="text" class="form-control" name="inputLongitudVisible" placeholder="Seleccione un punto en el mapa" readonly value="{{longitudMarcador}}">
                            <input type="hidden" class="form-control" formControlName="inputLongitud" name="inputLongitud" value="{{longitudMarcador}}">
                            <div class="invalid-feedback d-block" *ngIf="formulario.controls.inputLongitud.errors?.required && formulario.touched">
                                Seleccione en el mapa la ubicación del predio
                            </div>
                        </div>
                    </div>
                    <div class="form-group row align-items-center mb-0" *ngIf="this.mapaVisible">
                        <label for="inputMapa" class="col-md-3 text-right control-label col-form-label">Mapa</label>
                        <div class="col-md-9 border-left pb-2 pt-2">
                        <google-map (mapClick)="clicMapa($event)"
                            height="300px"    
                            widht="50px"    
                            [zoom]="zoom"
                            [center]="centroMapa"
                            [options]="opcionesMapa"
                            >
                            <map-marker
                                [position]="posicionMarcador"
                                [label]="etiquetaMarcador"
                                [options]="opcionesMarcador"
                            >
                            </map-marker>
                        </google-map>
                        <button type="button" (click)="centrarUbicacionActual()" class="btn btn-info waves-effect waves-light ">Centrar en ubicación actual</button>
                        </div>
                    </div>
                </div>
                <div class="form-group text-center mt-3">
                    <div class="col-xs-12">
                        <button class="btn btn-info btn-lg btn-block text-uppercase waves-effect waves-light" type="submit">Actualizar</button>
                    </div>
                </div>
            </form>
        </ng-container>
        </div>
    </div>
</div>

