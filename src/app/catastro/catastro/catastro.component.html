<!-- ============================================================== -->
<!-- Preloader - style you can find in spinners.css -->
<!-- ============================================================== -->
<div class="preloader">
    <div class="lds-ripple">
        <div class="lds-pos"></div>
        <div class="lds-pos"></div>
    </div>
</div>
<hr class="mt-0" />
<!-- Panel para mostrar la solicitud -->
<div class="panel-flotante" *ngIf="panelSolicitud">
    <div class="row m-5">
        <div class="col">
            <div class="card border border-success rounded">
                <div class="card-header bg-success text-white rounded-top">
                    Solicitud de corrección de catastro bovino
                    <span class="text-uppercase font-weight-bold">
                        {{ formularioSolicitud.value.nombre_provincia }} - {{ formularioSolicitud.value.nombre_canton }} - {{ formularioSolicitud.value.nombre_parroquia }}
                    </span>
                </div>
                <div class="card-body">
                    <div class="row">
                        <form ngNativeValidate [formGroup]="formularioSolicitud" (ngSubmit)="enviarSolicitudCorreccion()" class="form-horizontal r-separator">
                            <table class="table mt-3 table-borderless v-middle">
                                <thead>
                                    <tr>
                                        <th></th>
                                        <th class="pl-0 text-center"><img width="50" src="assets/images/icon/vaca.svg" alt="Income" /></th>
                                        <th></th>
                                        <th class="pl-0 text-center"><img width="50" src="assets/images/icon/toro.svg" alt="Income" /></th>
                                        <th></th>
                                        <th></th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <tr>
                                        <td></td>
                                        <td class="pl-0 text-left">Terneras:</td>
                                        <td class="pl-0 text-left">
                                            <input formControlName="terneras_solicitado" class="form-control" type="number" value="0.0" min="0.0">
                                        </td>
                                        <td class="pl-0 text-left">Terneros:</td>
                                        <td class="pl-0 text-left">
                                            <input formControlName="terneros_solicitado" class="form-control" type="number" value="0.0" min="0.0">
                                        </td>
                                        <td></td>
                                    </tr>
                                    <tr>
                                        <td></td>
                                        <td class="pl-0 text-left">Vaconas:</td>
                                        <td class="pl-0 text-left">
                                            <input formControlName="vaconas_solicitado" class="form-control" type="number" value="0.0" min="0.0">
                                        </td>
                                        <td class="pl-0 text-left">Toretes:</td>
                                        <td class="pl-0 text-left">
                                            <input formControlName="toretes_solicitado" class="form-control" type="number" value="0.0" min="0.0">
                                        </td>
                                        <td></td>
                                    </tr>
                                    <tr>
                                        <td></td>
                                        <td class="pl-0 text-left">Vacas:</td>
                                        <td class="pl-0 text-left">
                                            <input formControlName="vacas_solicitado" class="form-control" type="number" value="0.0" min="0.0">
                                        </td>
                                        <td class="pl-0 text-left">Toros:</td>
                                        <td class="pl-0 text-left">
                                            <input formControlName="toros_solicitado" class="form-control" type="number" value="0.0" min="0.0">
                                        </td>
                                        <td></td>
                                    </tr>
                                </tbody>
                                <tfoot>
                                    <tr class="table-secondary">
                                        <td class=" pl-0 font-weight-bold">Total</td>
                                        <td class="pl-0 text-left font-weight-bold"> </td>
                                        <td class="pl-0 text-left font-weight-bold"> {{ formularioSolicitud.value.terneras_solicitado + formularioSolicitud.value.vaconas_solicitado + formularioSolicitud.value.vacas_solicitado }}</td>
                                        <td class="pl-0 text-left font-weight-bold"> </td>
                                        <td class="pl-0 text-left font-weight-bold"> {{ formularioSolicitud.value.terneros_solicitado + formularioSolicitud.value.toretes_solicitado + formularioSolicitud.value.toros_solicitado }}</td>
                                        <td class="pl-0 text-left font-weight-bold">
                                            <span class="round rounded-circle text-white d-inline-block text-center bg-danger"> {{ formularioSolicitud.value.terneras_solicitado + formularioSolicitud.value.vaconas_solicitado + formularioSolicitud.value.vacas_solicitado + formularioSolicitud.value.terneros_solicitado + formularioSolicitud.value.toretes_solicitado + formularioSolicitud.value.toros_solicitado }} </span>
                                        </td>
                                    </tr>
                                </tfoot>
                            </table>
                            <div class="card-body">
                                <div class="form-group mb-0">
                                    <button type="submit" class="btn btn-success waves-effect waves-light">Enviar solicitud</button>
                                    <button type="button" class="btn btn-youtube waves-effect waves-light" (click)="cerrarPanelSolicitud()">Cancelar</button>
                                </div>
                            </div>
                        </form>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
<!-- Panel para mostrar el catastro por confirmar -->
<div class="row" *ngFor="let itemCatastro of catastroSinConfirmar">
    <div class="col">
        <div class="card border border-warning rounded">
            <div class="card-header bg-warning text-white rounded-top">
                Catastro sin confirmar en
                <span class="text-uppercase font-weight-bold">
                    {{ itemCatastro.nombreProvincia }} - {{ itemCatastro.nombreCanton }} - {{ itemCatastro.nombreParroquia }}
                </span>
            </div>
            <div class="card-body">
                <div class="row">
                    <table class="table mt-3 table-borderless v-middle">
                        <thead>
                            <tr>
                                <th></th>
                                <th class="pl-0 text-center"><img width="50" src="assets/images/icon/vaca.svg" alt="Hembra" /></th>
                                <th></th>
                                <th class="pl-0 text-center"><img width="50" src="assets/images/icon/toro.svg" alt="Macho" /></th>
                                <th></th>
                                <th></th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td></td>
                                <td class="pl-0 text-left">Terneras:</td>
                                <td class="pl-0 text-left">{{ itemCatastro.terneras }}</td>
                                <td class="pl-0 text-left">Terneros:</td>
                                <td class="pl-0 text-left">{{ itemCatastro.terneros }}</td>
                                <td></td>
                            </tr>
                            <tr>
                                <td></td>
                                <td class="pl-0 text-left">Vaconas:</td>
                                <td class="pl-0 text-left">{{ itemCatastro.vaconas }}</td>
                                <td class="pl-0 text-left">Toretes:</td>
                                <td class="pl-0 text-left">{{ itemCatastro.toretes }}</td>
                                <td></td>
                            </tr>
                            <tr>
                                <td></td>
                                <td class="pl-0 text-left">Vacas:</td>
                                <td class="pl-0 text-left">{{ itemCatastro.vacas }}</td>
                                <td class="pl-0 text-left">Toros:</td>
                                <td class="pl-0 text-left">{{ itemCatastro.toros }}</td>
                                <td></td>
                            </tr>
                        </tbody>
                        <tfoot>
                            <tr class="table-secondary">
                                <td class=" pl-0 font-weight-bold">Total</td>
                                <td class="pl-0 text-left font-weight-bold"> </td>
                                <td class="pl-0 text-left font-weight-bold"> {{ itemCatastro.terneras + itemCatastro.vaconas + itemCatastro.vacas }}</td>
                                <td class="pl-0 text-left font-weight-bold"> </td>
                                <td class="pl-0 text-left font-weight-bold"> {{ itemCatastro.terneros + itemCatastro.toretes + itemCatastro.toros }}</td>
                                <td class="pl-0 text-left font-weight-bold">
                                    <span class="round rounded-circle text-white d-inline-block text-center bg-danger"> {{ itemCatastro.terneras + itemCatastro.vaconas + itemCatastro.vacas + itemCatastro.terneros + itemCatastro.toretes + itemCatastro.toros }} </span>
                                </td>
                            </tr>
                        </tfoot>
                    </table>
                </div>
            </div>
            <div class="card-body">
                <div class="form-group mb-0">
                    <button type="button" class="btn btn-warning waves-effect waves-light" (click)="confirmarCatastro(itemCatastro)">Confirmar catastro</button>
                    <button type="button" class="btn btn-info waves-effect waves-light" (click)="mostrarPanelSolicitud(itemCatastro)">Solicitar corrección</button>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- Panel para mostrar el catastro -->
<div class="row">
    <div class="col">
        <div class="card border border-info rounded">
            <div class="card-header bg-info text-white rounded-top">
                Catastro bovino
            </div>
            <div class="card-body">
                <div class="row badge-light-info p-3">
                    <!--div class="toolbar"-->
                    <div class="row">
                        <div class="col">
                            <div class="input-group">
                                <input class="form-control" [(ngModel)]="identificador" type="text" placeholder="ID" />
                                <div class="input-group-append">
                                    <select [(ngModel)]="categoria" class="form-control">
                                        <option [value]="null" selected disabled>Categoría</option>
                                        <option *ngFor="let categoria of categorias" [ngValue]="categoria.id_categoria" > {{ categoria.nombre }} </option>
                                    </select>
                                </div>
                                <div class="input-group-append">
                                    <select [(ngModel)]="sitio" class="form-control">
                                        <option [value]="null" selected disabled>Fincas</option>
                                        <option *ngFor="let sitio of sitios" [ngValue]="sitio.idSitio" >{{ sitio.nombre }} </option>
                                    </select>
                                </div>
                            </div>
                        </div>
                        <div class="col-1">
                            <button data-toggle="tooltip" title="Buscar" class="btn btn-info btn-circle waves-effect waves-light" type="button" (click)="buscarBovinos()">
                                <span class="btn-label">
                                    <i class="fas fa-search"></i>
                                </span>
                            </button>
                        </div>
                        <div class="col-1">
                            <button data-toggle="tooltip" title="Reestablecer" class="btn btn-info btn-circle waves-effect waves-light" type="button" (click)="reestablecerControles()">
                                <span class="btn-label"><i class="fas fa-redo"></i></span>
                            </button>
                        </div>
                        <div class="col-md-3">
                            <a routerLinkActive="active" routerLink="/bovino/nuevo">
                                <button data-toggle="tooltip" title="Registrar nacimiento" class="btn btn-success btn-circle waves-effect waves-light" type="button">
                                    <span class="btn-label"><i class="fas fa-plus"></i></span>
                                </button>
                            </a>
                        </div>
                    </div>
                    <!--/div-->
                </div>
                <div class="row p-3">
                    <div class="col">
                        <div class="table-wrapper-scroll-y custom-scrollbar">
                            <table class="table table-bordered">
                                <thead>
                                    <tr>
                                        <th>Identificación oficial</th>
                                        <th>Datos de identificación</th>
                                        <th>Sexo</th>
                                        <th>Categoría</th>
                                        <th>Raza</th>
                                        <th></th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <tr *ngFor="let bovino of listaBovinos">
                                        <th>{{ bovino.codigoIdentificacion }}</th>
                                        <td>
                                            <span class="badge badge-dark-danger rounded-pill" *ngIf="bovino.identificacionVirtual">
                                                <span class="font-weight-bold text-dark">Identificación virtual: 
                                                </span>{{ bovino.identificacionVirtual}}
                                            </span>
                                            <span *ngIf="bovino.registroNacimientoProvisional" class="font-12 text-nowrap d-block text-muted text-truncate invoice-id">
                                                <span class="font-weight-bold text-dark">Registro de Nacimiento Provisional (RNP): 
                                                </span>{{bovino.registroNacimientoProvisional}}
                                            </span>
                                            <span *ngIf="bovino.registroNacimientoDefinitivo" class="font-12 text-nowrap d-block text-muted text-truncate invoice-id">
                                                <span class="font-weight-bold text-dark">Registro de Nacimiento Definitivo (RND): 
                                                </span>{{bovino.registroNacimientoDefinitivo}}
                                            </span>
                                            <span *ngIf="bovino.tatuaje" class="font-12 text-nowrap d-block text-muted text-truncate invoice-id">
                                                <span class="font-weight-bold text-dark">Tatuaje:</span> {{ bovino.tatuaje }}</span>
                                            <span *ngIf="bovino.marca" class="font-12 text-nowrap d-block text-muted text-truncate invoice-id">
                                                <span class="font-weight-bold text-dark">Marca: 
                                                </span> {{ bovino.marca }}
                                            </span>
                                        </td>

                                        <td>
                                            <img class="mr-3" src="assets/images/icon/vaca.svg" [hidden]="bovino.codigoSexo === 'macho'" width="50" alt="Generic placeholder image" />
                                            <img class="mr-3" src="assets/images/icon/toro.svg" [hidden]="bovino.codigoSexo === 'hembra'" width="50" alt="Generic placeholder image" />
                                        </td>
                                        <td>
                                            <span *ngIf="bovino.nombreCategoria">
                                                {{ bovino.nombreCategoria }}
                                            </span>
                                            <span *ngIf="bovino.nombreComunTaxonomia && bovino.nombreCategoria === null">
                                                {{ bovino.nombreComunTaxonomia }}
                                            </span>
                                        </td>
                                        <td>
                                            {{ bovino.nombreComunRaza }}
                                        </td>
                                        <td>
                                            <button *ngIf="bovino.codigoIdentificacion" type="button" class="btn waves-effect waves-light btn-info" (click)="mostrarHistoricoBovino(bovino.idBovino)">
                                                <i class="fas fa-history"></i>
                                                Histórico bovino
                                            </button>
                                            <button type="button" class="btn waves-effect waves-light btn-danger" routerLink="/baja-bovino/{{bovino.idBovino}}">
                                                <i class="fas fa-ribbon"></i>
                                                Baja de bovino
                                            </button>
                                        </td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- Panel para mostrar información flotante -->

<aside class="customizer" [ngClass]="{ 'show-service-panel': panelHistorico}">
    <div class="text-center" *ngIf="consultando">
        <div class="spinner-border m-3" role="status">
            <span class="sr-only">Cargando...</span>
        </div>
    </div>
    <button type="button" [ngClass]="{'boton-cierre-panel':panelHistorico}" class="btn btn-danger btn-circle" (click)="cerrarPanel()">
      <i class="fa fa-times">
      </i>
    </button>
    <div class="customizer-body desplazable">
        <div class="tab-content">
            <div class="tab-pane fade show active" id="pills-contact" role="tabpanel" aria-labelledby="pills-contact-tab">
                <h6 class="mt-3 mb-3">Histórico de bovino</h6>
                <div class="steamline">
                    <div class="sl-item" *ngFor="let historia of listaHistoriasBovino">
                        <div class="sl-left bg-success">
                            <i class="fas fa-truck" *ngIf="historia.tipoHistoria.codigo === 'MOV'"></i>
                            <i class="ti-heart" *ngIf="historia.tipoHistoria.codigo === 'NCT'"></i>
                            <i class="ti-check-box" *ngIf="historia.tipoHistoria.codigo === 'CTRL-M'"></i>
                            <i class="ti-id-badge" *ngIf="historia.tipoHistoria.codigo === 'IDI'"></i>
                            <i class="fas fa-stethoscope" *ngIf="historia.tipoHistoria.codigo === 'ATEN-VET'"></i>
                            <i class="fas fa-stethoscope" *ngIf="historia.tipoHistoria.codigo === 'RART'"></i>
                            <i class="fas fa-ribbon" *ngIf="historia.tipoHistoria.codigo === 'FNT'"></i> {{historia.tipoHistoria.codigo}}
                        </div>
                        <div class="sl-right">
                            <div class="font-weight-medium">
                                {{ historia.tipoHistoria?.nombre }} <span class="sl-date"> {{ historia.fechaCreacion }}</span>
                            </div>
                            <div class="desc">{{ historia.detalle }}</div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</aside>