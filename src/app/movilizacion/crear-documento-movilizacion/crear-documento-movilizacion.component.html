<hr class="mt-0">
<!-- Sección para buscar los últomos 100 czpm-m emitidos por el productor -->
<div class="row" *ngIf="!formularioVisible">
    <div class="col">
        <div class="card border border-info rounded">
            <div class="card-header bg-info text-white rounded-top font-weight-bold">
                Buscar Certificados Zoosanitarios de Producción y Movilidad -
                Movilización [CZPM-M]
            </div>
            <form ngNativeValidate [formGroup]="formularioBusqueda" class="form-horizontal r-separator">
                <div class="card-body">
                    <div class="form-group row align-items-center mb-0">
                        <label class="col-md-3 text-right control-label col-form-label font-weight-bold">
                            Sitio(s) de origen
                        </label>
                        <div class="col-md-8 border-left pb-2 pt-2">
                            <select formControlName="inputIdArea" class="form-control border-secondary font-weight-bold"
                                #idSitio (change)="cambioSitio()">
                                <option [value]="null" selected disabled>--- Seleccione una opción ---</option>
                                <option *ngFor="let area of listaAreasOrigen" [value]="area.idArea">{{
                                    area.codigoSitio.toUpperCase()}} | {{ area.nombreProvinciaSitio.toUpperCase()}} - {{
                                    area.nombreCantonSitio.toUpperCase()}} | {{ area.nombre.toUpperCase() }}</option>
                            </select>
                        </div>
                    </div>
                    <div class="form-group row align-items-center mb-0">
                        <label class="col-md-3 text-right control-label col-form-label font-weight-bold">
                            Estado del documento
                        </label>
                        <div class="col-md-3 border-left pb-2 pt-2 input-group font-weight-bold">
                            <select class="form-control border-secondary font-weight-bold"
                                formControlName="inputIdEstadoDocumento" (change)="cambioEstado()">
                                <option [value]="-1" selected enabled>--- Todos ---</option>
                                <option *ngFor="let estado of listaEstadosDocumentos"
                                    [value]="estado.idEstadoDocumento">
                                    {{ estado.nombre }}
                                </option>
                            </select>
                        </div>
                    </div>
                    <div class="form-group row align-items-center mb-0">
                        <label class="col-md-3 text-right control-label col-form-label font-weight-bold">
                            Nro. CZPM-M
                        </label>
                        <div class="col-md-3 border-left pb-2 pt-2 input-group">
                            <input type="text" class="form-control border-secondary" autocomplete="on"
                                (input)="limpiarNumeroDocumento()" formControlName="inputNumeroDocumento"
                                placeholder="(opcional)" maxlength="18">
                        </div>
                    </div>
                    <div class="form-group row align-items-center mt-4"> <!-- Ajuste de margen -->
                        <div class="col-md-6"></div>
                        <div class="col-md-5 text-right">
                            <div class="btn-group">
                                <button type="submit" class="btn btn-info me-3 px-4" (click)="buscarCertificado()"
                                    style="font-weight: bold;">
                                    <i class="fas fa-search"></i> Buscar
                                </button>&nbsp;&nbsp;&nbsp;&nbsp;
                                <button class="btn btn-success px-4" (click)="accionNuevoBoton()"
                                    style="font-weight: bold;">
                                    <i class="fa fa-plus"></i> Nuevo
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
            </form>
        </div>
    </div>
</div>
<!-- Tabla con el resultado de la búsqueda -->
<div class="row" *ngIf="listaCertificadosMovilizacion.length > 0 && !formularioVisible">
    <div class="col">
        <div class="card border border-secondary rounded">
            <div class="card-header bg-secondary text-white">
                <span class="font-weight-bold">
                    Listado de Certificados Zoosanitarios de Producción y Movilidad - Movilización (últimos 100
                    emitidos)
                </span>
                <span class="round rounded-circle text-white font-weight-bold d-inline-block text-center bg-info">
                    {{listaCertificadosMovilizacion.length }}
                </span>
            </div>
            <div class="card-body">
                <div class="row p-3">
                    <div #scrollContainer class="col table-wrapper-scroll-y custom-scrollbar">
                        <table class="table table-bordered table-hover v-middle">
                            <thead>
                                <tr>
                                    <th class="badge-light-info text-left font-16">Documento</th>
                                    <th class="badge-light-info text-left font-16">Validez</th>
                                    <th class="badge-light-info text-left font-16">Origen</th>
                                    <th class="badge-light-info text-left font-16">Destino</th>
                                    <th class="badge-light-info text-left font-16" style="width: 150px;">Productos</th>
                                    <th class="badge-light-info text-center font-16">Operación</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr *ngFor="let certificado of listaCertificadosMovilizacion">
                                    <td>
                                        <p><span class="font-weight-bold">{{ certificado.codigo }} </span>
                                        </p>
                                        <p style="font-size:x-small;" *ngIf="!certificado.placaVehiculo"><span
                                                class="font-weight-bold">
                                                MOVILIZA A PIE
                                            </span></p>
                                        <p style="font-size:smaller;" *ngIf="certificado.placaVehiculo"><span
                                                class="font-weight-bold">
                                                Transporte:
                                            </span></p>
                                        <p class="font-weight-bold" style="font-size:x-small;"
                                            *ngIf="certificado.placaVehiculo">
                                            [{{ certificado.placaVehiculo }}] - {{ certificado.marcaVehiculo }}
                                            {{ certificado.modeloVehiculo }} </p>
                                        <p style="font-size:smaller;" *ngIf="certificado.placaVehiculo"><span
                                                class="font-weight-bold">
                                                Transportista:
                                            </span></p>
                                        <p class="font-weight-bold" style="font-size:x-small;"
                                            *ngIf="certificado.placaVehiculo">
                                            [{{certificado.cedulaTransportista }}] - {{
                                            certificado.nombreCompletoTransportista }} </p>
                                    </td>
                                    <td>
                                        <p style="font-size:smaller;"><span class="font-weight-bold">Estado: </span>
                                            <span class="badge rounded-pill"
                                                [ngClass]="{'badge-warning text-white': certificado.codigoEstadoDocumento==='ET', 'badge-light-info':certificado.codigoEstadoDocumento==='G', 'badge-danger':certificado.codigoEstadoDocumento==='A', 'badge-info':certificado.codigoEstadoDocumento==='C', 'badge-success':certificado.codigoEstadoDocumento==='ER'}">
                                                {{ certificado.nombreEstadoDocumento.toLowerCase() }}
                                            </span>
                                        </p>

                                        <p style="font-size:smaller;"><span class="font-weight-bold">Emitido: </span> {{
                                            certificado.fechaEmisionFormateada
                                            }} </p>
                                        <p style="font-size:smaller;"><span class="font-weight-bold">Moviliza:
                                            </span> {{
                                            certificado.fechaHoraMovilizacionFormateada }} </p>
                                        <p style="font-size:smaller;"><span class="font-weight-bold">Válido hasta:
                                            </span> {{
                                            certificado.fechaHoraFinMovilizacionFormateada }} </p>
                                        <p style="font-size:smaller;" *ngIf="certificado.fechaHoraAutoriza"><span
                                                class="font-weight-bold">Autorización: </span> {{
                                            certificado.fechaHoraAutorizaFormateada }} [{{ certificado.usuarioAutoriza
                                            }}] </p>
                                        <p style="font-size:smaller;" *ngIf="certificado.fechaHoraConfirmacion"><span
                                                class="font-weight-bold">Confirmación: </span> {{
                                            certificado.fechaHoraConfirmacionFormateada }} [{{
                                            certificado.usuarioConfirma }}]
                                        </p>
                                        <p style="font-size:smaller;" *ngIf="certificado.fechaHoraAnula"><span
                                                class="font-weight-bold">Anulación:
                                            </span> {{ certificado.fechaHoraAnulaFormateada }} [{{
                                            certificado.usuarioAnula }}]
                                        </p>

                                    </td>
                                    <td>
                                        <p><span class="badge rounded-pill font-weight-bold badge-info">
                                                {{ certificado.codigoSitioOrigen }}
                                            </span></p>
                                        <p>
                                            <span class="font-weight-bold" style="font-size:x-small;">
                                                {{ certificado.nombreTiposAreasOrigen.toUpperCase() }}
                                            </span>
                                        </p>
                                        <p>
                                            <span class="font-weight-bold" style="font-size:smaller;">
                                                {{ certificado.nombreAreaOrigen.toUpperCase() }}
                                            </span>
                                        </p>
                                        <p class="font-weight-bold" style="font-size:x-small;">
                                            [{{ certificado.numeroIdentificacion }}] - {{ certificado.nombresProductor
                                            }}
                                        </p>
                                        <p style="font-size:smaller;"><span class="font-weight-bold">Ubicación:</span>
                                            {{ certificado.nombreProvinciaOrigen }} /
                                            {{ certificado.nombreCantonOrigen }} /
                                            {{ certificado.nombreParroquiaOrigen }}
                                        </p>
                                    </td>
                                    <td>
                                        <p><span class="badge rounded-pill font-weight-bold badge-secondary">
                                                {{ certificado.codigoSitioDestino }}
                                            </span></p>
                                        <p>
                                            <span class="font-weight-bold" style="font-size:x-small;">
                                                {{ certificado.nombreTiposAreasDestino.toUpperCase() }}
                                            </span>
                                        </p>
                                        <p class="font-weight-bold" style="font-size:smaller;">
                                            {{ certificado.nombreAreaDestino.toUpperCase() }}
                                        </p>
                                        <p class="font-weight-bold" style="font-size:x-small;">
                                            [{{ certificado.numeroIdentificacionPropietarioSitioDestino }}] -
                                            {{ certificado.nombresPropietarioSitioDestino }}
                                        </p>
                                        <p style="font-size:smaller;"><span class="font-weight-bold">Ubicación:</span>
                                            {{ certificado.nombreProvinciaDestino }} /
                                            {{ certificado.nombreCantonDestino }} /
                                            {{ certificado.nombreParroquiaDestino }}
                                        </p>
                                    </td>
                                    <td>
                                        <h5 style="font-size:medium;" class="mb-0 font-weight-bold">
                                            <li
                                                *ngFor="let categoria of obtenerCategoriasYValoresPorIdCertificado(certificado.idCertificadoMovilizacion)">
                                                {{ categoria[0] }}: {{ categoria[1] }}
                                            </li>
                                        </h5>
                                    </td>
                                    <td class="text-center">
                                        <p *ngIf="certificado.codigoEstadoDocumento!=='A'">
                                            <button type="button" class="btn waves-effect waves-light"
                                                style="background-color: #ffc107; color: #212529; border: none; border-radius: 25px; padding: 10px 20px; font-size: 14px; font-weight: bold; box-shadow: 0 4px 6px rgba(0, 0, 0, 0.2); transition: all 0.3s ease; width: 180px;"
                                                [title]="generarTitulo(certificado,'Descargar')"
                                                (click)="generarPDF(certificado.idCertificadoMovilizacion)"
                                                onmouseover="this.style.backgroundColor='#e0a800'; this.style.boxShadow='0 6px 8px rgba(0, 0, 0, 0.3)';"
                                                onmouseout="this.style.backgroundColor='#ffc107'; this.style.boxShadow='0 4px 6px rgba(0, 0, 0, 0.2)';">
                                                <i class="fas fa-download"
                                                    style="color: #212529; font-size: 18px; margin-right: 8px;"></i>
                                                Descargar
                                            </button>
                                        </p>
                                        <p *ngIf="certificado.codigoEstadoDocumento==='G'">
                                            <button type="button" class="btn waves-effect waves-light"
                                                style="background-color: #FF0000; color: white; border: none; border-radius: 25px; padding: 10px 20px; font-size: 14px; font-weight: bold; box-shadow: 0 4px 6px rgba(0, 0, 0, 0.2); transition: all 0.3s ease; width: 180px;"
                                                [title]="generarTitulo(certificado)"
                                                (click)="actualizarEstado(certificado)"
                                                onmouseover="this.style.backgroundColor='#CC0000'; this.style.boxShadow='0 6px 8px rgba(0, 0, 0, 0.3)';"
                                                onmouseout="this.style.backgroundColor='#FF0000'; this.style.boxShadow='0 4px 6px rgba(0, 0, 0, 0.2)';">
                                                <i class="fa fa-times-circle"
                                                    style="color: white; font-size: 18px; margin-right: 8px;"></i>
                                                Anular
                                            </button>
                                        </p>
                                        <p *ngIf="certificado.codigoEstadoDocumento==='A'" style="font-size:smaller;">
                                            <span class="badge rounded-pill badge-danger">
                                                documento anulado
                                            </span>
                                        </p>
                                    </td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
<div *ngIf="formularioVisible" class='row'>
    <div class='col'>
        <div class='card border-info rounded'>
            <div class="card-header rounded-top bg-info text-white font-weight-bold">
                Certificado Zoosanitario de Producción y Movilidad - Movilización (CZPM-M)
            </div>
            <hr class="mt-0">
            <div class='card-body'>
                <form ngNativeValidate [formGroup]="formulario" (keydown.enter)="$event.preventDefault()"
                    (ngSubmit)="registrarCertificado()" class="form-horizontal r-separator needs-validation">
                    <!-- Sitio de origen -->
                    <div class="card-body">
                        <h4 class="card-title">Sitio(s) de origen (activos)</h4>
                        <div class="form-group row align-items-center">
                            <label class="col-md-3 text-right control-label col-form-label font-weight-bold">
                                Seleccione un sitio
                            </label>
                            <div class="col-md-9 border-left">
                                <select class="form-control border-secondary font-weight-bold"
                                    formControlName="inputIdAreaOrigen" (change)="cambioAreaOrigen()">
                                    <option [value]="null" selected disabled>--- Seleccione una opción ---</option>
                                    <option *ngFor="let area of listaAreasOrigen" [value]="area.idArea">
                                        {{ area.codigoSitio}} |
                                        {{ area.nombreProvinciaSitio.toUpperCase()}} -
                                        {{ area.nombreCantonSitio.toUpperCase()}} |
                                        {{ area.nombre.toUpperCase() }}
                                    </option>
                                </select>
                                <div class="invalid-feedback d-block font-weight-bold"
                                    *ngIf="formulario.controls.inputIdAreaOrigen.errors?.required && formulario.touched">
                                    Seleccione un sitio de origen
                                </div>
                            </div>
                        </div>
                    </div>
                    <!-- Panel para mostrar datos del sitio seleccionado -->
                    <div class="row">
                        <div class="col">
                            <form ngNativeValidate [formGroup]="formularioInfoSitioOrigen"
                                class="form-horizontal r-separator">
                                <!-- Botón para ocultar/mostrar -->
                                <button *ngIf="isVisibleBotonDetallesOrigen" class="btn btn-info mb-3 font-weight-bold"
                                    (click)="toggleVisibility('origen')">
                                    <i class="fas {{ isVisibleOrigen ? 'fa-eye-slash' : 'fa-eye' }}"></i>
                                    {{ isVisibleOrigen ? 'Ocultar' : 'Mostrar' }} detalles del sitio de origen
                                </button>
                                <!-- Datos del sitio -->
                                <div class="row" *ngIf="isVisibleOrigen">
                                    <div class="col">
                                        <div class="card border rounded">
                                            <div class="card-body">
                                                <table class="table mt-3 table-borderless v-middle custom-table">
                                                    <tbody>
                                                        <tr>
                                                            <td></td>
                                                            <td class="pl-0 text-left">PROPIETARIO:</td>
                                                            <td class="pl-0 text-left font-weight-medium">
                                                                <p>
                                                                    <span class="pl-0 text-left font-weight-medium">
                                                                        [{{
                                                                        origenSeleccionado?.numeroIdentificacion
                                                                        }}]
                                                                    </span>
                                                                    <span>&nbsp;&nbsp;</span>
                                                                    <span class="pl-0 text-left font-weight-medium">
                                                                        {{
                                                                        origenSeleccionado?.nombres.toUpperCase()
                                                                        }}
                                                                    </span>
                                                                </p>
                                                            </td>
                                                            <td class="pl-0 text-left">PROVINCIA:</td>
                                                            <td class="pl-0 text-left font-weight-medium">{{
                                                                origenSeleccionado?.nombreProvinciaSitio.toUpperCase()
                                                                }}</td>
                                                            <td></td>
                                                        </tr>
                                                        <tr>
                                                            <td></td>
                                                            <td class="pl-0 text-left">CÓDIGO-SITIO:</td>
                                                            <td class="pl-0 text-left font-weight-medium">

                                                                <p><span
                                                                        class="badge rounded-pill font-weight-bold letra badge-info">
                                                                        {{ origenSeleccionado?.codigoSitio }}
                                                                    </span></p>
                                                            </td>
                                                            <td class="pl-0 text-left">CANTÓN:</td>
                                                            <td class="pl-0 text-left font-weight-medium">{{
                                                                origenSeleccionado?.nombreCantonSitio.toUpperCase()
                                                                }}</td>
                                                            <td></td>
                                                        </tr>
                                                        <tr>
                                                            <td></td>
                                                            <td class="pl-0 text-left">TIPO ÁREA:</td>
                                                            <td class="pl-0 text-left font-weight-medium">{{
                                                                origenSeleccionado?.nombreTipoArea.toUpperCase() }}
                                                            </td>
                                                            <td class="pl-0 text-left">PARROQUIA:</td>
                                                            <td class="pl-0 text-left font-weight-medium">{{
                                                                origenSeleccionado?.nombreParroquiaSitio.toUpperCase()
                                                                }}</td>
                                                            <td></td>
                                                        </tr>
                                                        <tr>
                                                            <td></td>
                                                            <td class="pl-0 text-left">NOMBRE-SITIO:</td>
                                                            <td class="pl-0 text-left font-weight-medium">{{
                                                                origenSeleccionado?.nombre.toUpperCase() }}</td>
                                                            <td class="pl-0 text-left">DIRECCIÓN:</td>
                                                            <td class="pl-0 text-left font-weight-medium">{{
                                                                origenSeleccionado?.callePrincipalSitio.toUpperCase()
                                                                }}</td>
                                                            <td></td>
                                                        </tr>
                                                        <tr>
                                                            <td></td>
                                                            <td class="pl-0 text-left">COORDENADAS:</td>
                                                            <td class="pl-0 text-left font-weight-medium">
                                                                LAT [{{ origenSeleccionado?.latitudSitio }}] - LONG
                                                                [{{
                                                                origenSeleccionado?.longitudSitio }}]
                                                            </td>
                                                            <td class="pl-0 text-left">MAPA:</td>
                                                            <td class="pl-0 text-left font-weight-medium">
                                                                <button class="styled-button"
                                                                    (click)="abrirGoogleMaps(origenSeleccionado?.latitudSitio,origenSeleccionado?.longitudSitio)">
                                                                    <i class="fas fa-map-marker-alt"></i>&nbsp;Ver
                                                                    en
                                                                    Google Maps
                                                                </button>
                                                            </td>
                                                            <td></td>
                                                        </tr>
                                                    </tbody>
                                                </table>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </form>
                        </div>
                    </div>
                    <!-- Filtros del catastro de animales disponibles -->
                    <div *ngIf="isVisibleAnimales" class="card border border-secondary rounded">
                        <div class="card-header bg-secondary font-weight-bold text-white rounded-top">
                            Filtros de búsqueda de animales
                        </div>
                        <div class="card-body">
                            <div class="form-row align-items-center mb-4">
                                <!-- Filtro 1: Tipo catastro -->
                                <div class="col-auto mr-5">
                                    <label class="control-label font-weight-bold mb-2">Tipo catastro:</label>
                                    <select class="form-control border-secondary font-weight-bold mt-1"
                                        style="min-width: 220px;" formControlName="inputTipoCatastro"
                                        (change)="cambioTipoCatastro()">
                                        <option *ngFor="let tipo of listaTiposCatastro" [value]="tipo.codigo">{{
                                            tipo.nombre }}
                                        </option>
                                    </select>
                                </div>
                                <!-- Filtro 2: Categoría etaria -->
                                <div class="col-auto mr-5">
                                    <label class="control-label font-weight-bold mb-2">Categoría etaria:</label>
                                    <select class="form-control border-secondary font-weight-bold mt-1"
                                        style="min-width: 220px;" formControlName="inputCategoria"
                                        (change)="cambioCategoria()">
                                        <option *ngFor="let categoria of categorias" [value]="categoria.id_categoria">
                                            {{ categoria.nombre }}
                                        </option>
                                    </select>
                                </div>
                                <!-- Filtro 3: Número de arete -->
                                <div class="col-auto mr-5">
                                    <label class="control-label font-weight-bold mb-2">Número de arete:</label>
                                    <div class="input-group mt-1" style="min-width: 250px;">
                                        <input type="text" class="form-control border-secondary"
                                            formControlName="inputIdOficial" placeholder="Ejemplo: EC006132716"
                                            maxlength="11">
                                        <div class="input-group-append">
                                            <button type="button" class="btn btn-info border-secondary font-weight-bold"
                                                (click)="buscarAnimales(true)">
                                                <i class="fas fa-search"></i>
                                            </button>
                                        </div>
                                    </div>
                                </div>
                                <!-- Botón mostrar todos -->
                                <div class="col-auto align-self-end ml-4">
                                    <button type="button" (click)="mostrarTodo()"
                                        class="btn btn-info font-weight-bold waves-effect waves-light px-4">
                                        <i class="fas fa-list mr-2"></i> Mostrar todos
                                    </button>
                                </div>
                            </div>
                        </div>
                    </div>
                    <!-- Lista de animales disponibles en el sitio -->
                    <div *ngIf="isVisibleAnimales" class="row">
                        <div class="col">
                            <div class="card card-body-fijo border border-secondary rounded">
                                <div style="height: 50px;"
                                    class="card-header bg-secondary text-white d-flex justify-content-between align-items-center">
                                    <span class="font-weight-bold">Lista de animales disponibles en el sitio</span>
                                    <div class="d-flex align-items-center ml-auto">
                                        <span
                                            class="round rounded-circle text-white d-inline-block text-center bg-info font-weight-bold">
                                            {{ listaAnimalesDisponibles.length }}
                                        </span>
                                    </div>
                                </div>
                                <div class="card-body p-1">
                                    <div #scrollContainer class="table-wrapper-scroll-y custom-scrollbar">
                                        <table class="table table-bordered table-hover v-middle">
                                            <tbody>
                                                <tr *ngFor="let bovino of listaAnimalesDisponibles">
                                                    <td class="text-center">
                                                        <span class="badge rounded-pill"
                                                            [ngClass]="bovino?.codigoIdentificacion ? 'badge-amarillo' : 'badge-secondary'">
                                                            {{ bovino?.codigoIdentificacion ?
                                                            bovino.codigoIdentificacion : bovino.idBovino
                                                            }}
                                                        </span>
                                                    </td>
                                                    <td class="text-center">
                                                        <span class="font-weight-bold">
                                                            {{ bovino?.nombreCategoria ? bovino.nombreCategoria :
                                                            bovino.nombreComunTaxonomia + ' ' + bovino.nombreSexo}}
                                                        </span>
                                                    </td>
                                                    <td class="text-center">
                                                        <img style="display: block; margin: auto;"
                                                            src="assets/images/icon/vaca.svg"
                                                            [hidden]="bovino.codigoSexo === 'macho'" width="30"
                                                            alt="Generic placeholder image" />
                                                        <img style="display: block; margin: auto;"
                                                            src="assets/images/icon/toro.svg"
                                                            [hidden]="bovino.codigoSexo === 'hembra'" width="30"
                                                            alt="Generic placeholder image" />
                                                    </td>
                                                    <td class="text-center font-weight-bold">
                                                        <div class="d-flex flex-column align-items-center">
                                                            <p class="mb-1">
                                                                <span class="font-weight-bold">
                                                                    {{ bovino.nombreComunRaza }}
                                                                    ({{ bovino.nombrePureza.toLowerCase() }})
                                                                </span>
                                                            </p>
                                                            <p class="mb-0">
                                                                <span class="badge rounded-pill font-weight-bold"
                                                                    [ngClass]="{'badge-gris': bovino.estadoVacunacion == 'vacunado', 'badge-light-danger': bovino.estadoVacunacion == 'nacimiento'}">
                                                                    <span
                                                                        *ngIf="bovino.estadoVacunacion == 'nacimiento'">
                                                                        {{ bovino.estadoVacunacion.toLowerCase() }}
                                                                    </span>
                                                                    <span *ngIf="bovino.estadoVacunacion == 'vacunado'">
                                                                        {{ bovino.estadoVacunacion.toLowerCase() }} ({{
                                                                        bovino.nombreFaseVacunacion.toUpperCase() }})
                                                                    </span>
                                                                </span>
                                                            </p>
                                                        </div>
                                                    </td>
                                                    <td class="text-center">
                                                        <button type="button" class="btn btn-success btn-circle"
                                                            (click)="agregarAnimal(bovino.idBovino)">
                                                            <i class="fas fa-plus"></i>
                                                        </button>
                                                    </td>
                                                </tr>
                                            </tbody>
                                        </table>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <!-- Lista de animales para movilizar -->
                        <div class="col">
                            <div class="card card-body-fijo border border-secondary rounded">
                                <div style="height: 50px;"
                                    class="card-header bg-secondary text-white d-flex justify-content-between align-items-center">
                                    <span class="font-weight-bold">
                                        Lista de animales seleccionados para movilizar
                                    </span>
                                    <span
                                        class="round rounded-circle d-inline-block text-center text-white badge-warning font-weight-bold">
                                        {{ listaAnimalesMovilizar.length }}
                                    </span>
                                </div>
                                <div class="card-body p-1">
                                    <div #scrollContainer class="table-wrapper-scroll-y custom-scrollbar">
                                        <table class="table table-bordered table-hover v-middle">
                                            <tbody>
                                                <tr *ngFor="let bovino of listaAnimalesMovilizar">
                                                    <td class="text-center">
                                                        <span class="badge rounded-pill"
                                                            [ngClass]="bovino?.codigoIdentificacion ? 'badge-amarillo' : 'badge-secondary'">
                                                            {{ bovino?.codigoIdentificacion ?
                                                            bovino.codigoIdentificacion : bovino.idBovino
                                                            }}
                                                        </span>
                                                    </td>
                                                    <td class="text-center">
                                                        <span class="font-weight-bold">
                                                            {{ bovino?.nombreCategoria ? bovino.nombreCategoria :
                                                            bovino.nombreComunTaxonomia + ' ' + bovino.nombreSexo}}
                                                        </span>
                                                    </td>
                                                    <td class="text-center">
                                                        <img style="display: block; margin: auto;"
                                                            src="assets/images/icon/vaca.svg"
                                                            [hidden]="bovino.codigoSexo === 'macho'" width="30"
                                                            alt="Generic placeholder image" />
                                                        <img style="display: block; margin: auto;"
                                                            src="assets/images/icon/toro.svg"
                                                            [hidden]="bovino.codigoSexo === 'hembra'" width="30"
                                                            alt="Generic placeholder image" />
                                                    </td>
                                                    <td class="text-center font-weight-bold">
                                                        <div class="d-flex flex-column align-items-center">
                                                            <p class="mb-1">
                                                                <span class="font-weight-bold">
                                                                    {{ bovino.nombreComunRaza }}
                                                                    ({{ bovino.nombrePureza.toLowerCase() }})
                                                                </span>
                                                            </p>
                                                            <p class="mb-0">
                                                                <span class="badge rounded-pill font-weight-bold"
                                                                    [ngClass]="{'badge-gris': bovino.estadoVacunacion == 'vacunado', 'badge-light-danger': bovino.estadoVacunacion == 'nacimiento'}">
                                                                    <span
                                                                        *ngIf="bovino.estadoVacunacion == 'nacimiento'">
                                                                        {{ bovino.estadoVacunacion.toLowerCase() }}
                                                                    </span>
                                                                    <span *ngIf="bovino.estadoVacunacion == 'vacunado'">
                                                                        {{ bovino.estadoVacunacion.toLowerCase() }} ({{
                                                                        bovino.nombreFaseVacunacion.toUpperCase() }})
                                                                    </span>
                                                                </span>
                                                            </p>
                                                        </div>
                                                    </td>
                                                    <td class="text-center">
                                                        <button type="button" class="btn btn-danger btn-circle"
                                                            (click)="quitarAnimal(bovino.idBovino)">
                                                            <i class="fas fa-minus"></i>
                                                        </button>
                                                    </td>
                                                </tr>
                                            </tbody>
                                        </table>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div *ngIf="isVisibleAnimales" class="row">
                        <!-- Bovinos en sitio -->
                        <div class="col">
                            <div class="card border border-secondary rounded">
                                <div style="display: flex; justify-content: space-between; align-items: center; height: 50px;"
                                    class="card-header bg-secondary text-white font-weight-bold rounded-top">
                                    <span>
                                        Total de animales disponibles en el sitio
                                    </span>
                                    <span style="float: right; padding-top: 0%;"
                                        class="round rounded-circle text-white d-inline-block text-center bg-info">
                                        {{ totalAnimalesDisponibles }}</span>
                                </div>
                                <div class="card-body">
                                    <div class="row">
                                        <table class="table mt-3 table-borderless v-middle">
                                            <tbody>
                                                <tr>
                                                    <td></td>
                                                    <td class="pl-0 text-left font-weight-bold">Terneras:</td>
                                                    <td class="pl-0 text-left">{{ ternerasDisponibles }}</td>
                                                    <td class="pl-0 text-left font-weight-bold">Terneros:</td>
                                                    <td class="pl-0 text-left">{{ ternerosDisponibles }}</td>
                                                    <td></td>
                                                </tr>
                                                <tr>
                                                    <td></td>
                                                    <td class="pl-0 text-left font-weight-bold">Vaconas:</td>
                                                    <td class="pl-0 text-left">{{ vaconasDisponibles }}</td>
                                                    <td class="pl-0 text-left font-weight-bold">Toretes:</td>
                                                    <td class="pl-0 text-left">{{ toretesDisponibles }}</td>
                                                    <td></td>
                                                </tr>
                                                <tr>
                                                    <td></td>
                                                    <td class="pl-0 text-left font-weight-bold">Vacas:</td>
                                                    <td class="pl-0 text-left">{{ vacasDisponibles }}</td>
                                                    <td class="pl-0 text-left font-weight-bold">Toros:</td>
                                                    <td class="pl-0 text-left">{{ torosDisponibles }}</td>
                                                    <td></td>
                                                </tr>
                                                <tr>
                                                    <td></td>
                                                    <td class="pl-0 text-left font-weight-bold">Búfalo Hembra:</td>
                                                    <td class="pl-0 text-left">{{ bufalosHembrasDisponibles }}</td>
                                                    <td class="pl-0 text-left font-weight-bold">Búfalo Macho:</td>
                                                    <td class="pl-0 text-left">{{ bufalosMachosDisponibles }}</td>
                                                    <td></td>
                                                </tr>
                                            </tbody>
                                        </table>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <!-- Bovinos a movilizarse -->
                        <div class="col">
                            <div class="card border border-secondary rounded">
                                <div style="display: flex; justify-content: space-between; align-items: center; height: 50px;"
                                    class="card-header bg-secondary text-white font-weight-bold rounded-top">
                                    <span>
                                        Total de animales a movilizar
                                    </span>
                                    <span style="float: right; padding-top: 0%;"
                                        class="round rounded-circle text-white d-inline-block text-center bg-warning">
                                        {{ totalAnimalesAgregados }}
                                    </span>
                                </div>
                                <div class="card-body">
                                    <div class="row">
                                        <table class="table mt-3 table-borderless v-middle">
                                            <tbody>
                                                <tr>
                                                    <td></td>
                                                    <td class="pl-0 text-left font-weight-bold">Terneras:</td>
                                                    <td class="pl-0 text-left">{{ ternerasAgregados }}</td>
                                                    <td class="pl-0 text-left font-weight-bold">Terneros:</td>
                                                    <td class="pl-0 text-left">{{ ternerosAgregados }}</td>
                                                    <td></td>
                                                </tr>
                                                <tr>
                                                    <td></td>
                                                    <td class="pl-0 text-left font-weight-bold">Vaconas:</td>
                                                    <td class="pl-0 text-left">{{ vaconasAgregados }}</td>
                                                    <td class="pl-0 text-left font-weight-bold">Toretes:</td>
                                                    <td class="pl-0 text-left">{{ toretesAgregados }}</td>
                                                    <td></td>
                                                </tr>
                                                <tr>
                                                    <td></td>
                                                    <td class="pl-0 text-left font-weight-bold">Vacas:</td>
                                                    <td class="pl-0 text-left">{{ vacasAgregados }}</td>
                                                    <td class="pl-0 text-left font-weight-bold">Toros:</td>
                                                    <td class="pl-0 text-left">{{ torosAgregados }}</td>
                                                    <td></td>
                                                </tr>
                                                <tr>
                                                    <td></td>
                                                    <td class="pl-0 text-left font-weight-bold">Búfalo Hembra:</td>
                                                    <td class="pl-0 text-left">{{ bufalosHembrasAgregados }}</td>
                                                    <td class="pl-0 text-left font-weight-bold">Búfalo Macho:</td>
                                                    <td class="pl-0 text-left">{{ bufalosMachosAgregados }}</td>
                                                    <td></td>
                                                </tr>
                                            </tbody>
                                        </table>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <hr class="mt-0">
                    <!------------------------------------------------------------------------------------------------------------>
                    <!-- Destino -->
                    <div class="card-body">
                        <!-- Tipo destino -->
                        <h4 class="card-title">Tipos de destino</h4>
                        <div class="form-group row align-items-center">
                            <label class="col-md-3 text-right control-label col-form-label font-weight-bold">
                                Seleccione un tipo
                            </label>
                            <div class="col-md-9 border-left pb-2 pt-2">
                                <!-- Centro de Faenamiento -->
                                <div class="row">
                                    <div class="col-md-auto">
                                        <input name="tipo_area" type="radio" id="c_faenamiento" [(ngModel)]="destino"
                                            [ngModelOptions]="{standalone: true}" value="cen_faen"
                                            (change)="cambioTipoSitio('cen_faen')"
                                            class="material-inputs radio-col-yellow">
                                        <label class="font-weight-bold" for="c_faenamiento">Centro de
                                            Faenamiento</label>
                                    </div>
                                </div>
                                <div class="row">
                                    <div class="col">
                                        <div class="row">
                                            <div class="col-md-auto">
                                                <input name="tipo_area" type="radio" id="c_concentracion"
                                                    [(ngModel)]="destino" [ngModelOptions]="{standalone: true}"
                                                    value="c_concentracion"
                                                    (change)="cambioTipoSitio('c_concentracion')"
                                                    class="material-inputs radio-col-red">
                                                <label class="font-weight-bold" for="c_concentracion">Centro de
                                                    Concentración Animal</label>
                                            </div>
                                        </div>
                                        <div class="row" *ngIf="destino === 'c_concentracion'">
                                            <div class="col-md-auto ml-4">
                                                <div class="row">
                                                    <div class="col-md-auto">
                                                        <input name="centro_concentracion" type="radio"
                                                            id="f_exposicion" [(ngModel)]="centro"
                                                            [ngModelOptions]="{standalone: true}" value="fer_exp"
                                                            (change)="cambioTipoSitio('fer_exp')"
                                                            class="material-inputs radio-col-red">
                                                        <label class="font-weight-bold" for="f_exposicion">Feria de
                                                            exposición</label>
                                                    </div>
                                                </div>
                                                <div class="row">
                                                    <div class="col-md-auto">
                                                        <input name="centro_concentracion" type="radio" id="f_comercial"
                                                            [(ngModel)]="centro" [ngModelOptions]="{standalone: true}"
                                                            value="fer_com" (change)="cambioTipoSitio('fer_com')"
                                                            class="material-inputs radio-col-red">
                                                        <label class="font-weight-bold" for="f_comercial">Feria
                                                            comercial</label>
                                                    </div>
                                                </div>
                                                <div class="row">
                                                    <div class="col-md-auto">
                                                        <input name="centro_concentracion" type="radio" id="c_hospedaje"
                                                            [(ngModel)]="centro" [ngModelOptions]="{standalone: true}"
                                                            value="cen_hos" (change)="cambioTipoSitio('cen_hos')"
                                                            class="material-inputs radio-col-red">
                                                        <label class="font-weight-bold" for="c_hospedaje">Centro de
                                                            hospedaje</label>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div class="row">
                                    <div class="col-md-auto">
                                        <input name="tipo_area" type="radio" id="e_pecuarioa" [(ngModel)]="destino"
                                            [ngModelOptions]="{standalone: true}" value="ex_pec_bov"
                                            (change)="cambioTipoSitio('ex_pec_bov')"
                                            class="material-inputs radio-col-black">
                                        <label class="font-weight-bold" for="e_pecuarioa">Explotación Pecuaria</label>
                                    </div>
                                </div>
                                <div class="invalid-feedback d-block font-weight-bold"
                                    *ngIf="formulario.controls.tipo_area.errors?.required && formulario.touched">
                                    Seleccione el tipo de destino
                                </div>
                            </div>
                        </div>
                    </div>
                    <hr *ngIf="destino == 'ex_pec_bov'" class="mt-0">
                    <div *ngIf="destino == 'ex_pec_bov'" class="card-body">
                        <!-- datos del destinatario -->
                        <h4 class="card-title">Datos del destinatario</h4>
                        <div class="form-group row align-items-center">
                            <label class="col-md-3 text-right control-label col-form-label font-weight-bold">
                                Número de identificación
                            </label>
                            <div class="col-md-9 border-left pb-2 pt-2 input-group">
                                <input type="text" style="width: 25%; min-width: 0; flex: 0 0 25%;"
                                    class="form-control border-secondary"
                                    (keydown.enter)="buscarProductoresDestino(productor.value)"
                                    (input)="limpiarDestinatario()" #productor maxlength="25"
                                    placeholder="Ingrese # de identificación">
                                <div class="input-group-append">
                                    <button type="button" class="btn btn-info border-secondary font-weight-bold"
                                        (click)="buscarProductoresDestino(productor.value)">
                                        <i class="fas fa-search"></i> Buscar
                                    </button>
                                </div>
                            </div>
                            <label class="col-md-3 text-right control-label col-form-label font-weight-bold">
                                Apellidos y nombres / Razón social
                            </label>
                            <div class="col-md-9 border-left pb-2 pt-2 input-group">
                                <input type="text" class="form-control border-secondary"
                                    formControlName="inputNombreReceptor"
                                    placeholder="Ingrese Apellidos y nombres / Razón social" readonly>
                            </div>
                        </div>
                    </div>
                    <hr *ngIf="destino !== ''" class="mt-0">
                    <div class="card-body">
                        <h4 *ngIf="destino !== ''" class="card-title">Sitio(s) de destino</h4>
                        <div class="form-group row align-items-center"
                            *ngIf="destino !== 'ex_pec_bov' && destino !== ''">
                            <label
                                class="col-md-3 text-right control-label col-form-label font-weight-bold">Provincia</label>
                            <div class="col-md-9 border-left pb-2 pt-2">
                                <select class="form-control border-secondary font-weight-bold"
                                    formControlName="inputProvinciaDestino" (change)="cargarSitioDestino()">
                                    <option [value]="null" selected disabled>--- Seleccione una opción ---</option>
                                    <option *ngFor="let provincia of listaProvincias"
                                        value="{{provincia.id_provincia}}">
                                        {{provincia.nombre.toUpperCase()}}</option>
                                </select>
                            </div>
                        </div>
                        <div class="form-group row align-items-center" *ngIf="destino !== ''">
                            <label class="col-md-3 text-right control-label col-form-label font-weight-bold">
                                Seleccione un sitio
                            </label>
                            <div class="col-md-9 border-left pb-2 pt-2">
                                <select class="form-control border-secondary font-weight-bold"
                                    formControlName="inputIdAreaDestino" (change)="cambioDestino()">
                                    <option [value]="null" selected disabled>--- Seleccione una opción ---</option>
                                    <option *ngFor="let destinoItem of listaAreasDestinos"
                                        [value]="destinoItem?.idArea">
                                        {{ destino === 'ex_pec_bov'
                                        ? (destinoItem?.codigoSitio + ' | ' +
                                        destinoItem?.nombreProvinciaSitio.toUpperCase() + ' - ' +
                                        destinoItem?.nombreCantonSitio.toUpperCase() + ' | ' +
                                        destinoItem?.nombre.toUpperCase())
                                        : (destinoItem?.codigoSitio + ' | ' +
                                        destinoItem?.nombreCantonSitio.toUpperCase() + ' | ' +
                                        destinoItem?.nombre.toUpperCase())
                                        }}
                                    </option>
                                </select>
                                <div class="invalid-feedback d-block font-weight-bold"
                                    *ngIf="formulario.controls['inputIdAreaDestino'].status==='INVALID' && formulario.touched">
                                    Seleccione un sitio de destino.
                                </div>
                            </div>
                        </div>
                    </div>
                    <hr *ngIf="isVisibleBotonDetallesDestino" class="mt-0">
                    <div class="card-body">
                        <div class="row">
                            <div class="col">
                                <form ngNativeValidate [formGroup]="formularioInfoSitioDestino"
                                    class="form-horizontal r-separator">
                                    <!-- Botón para ocultar/mostrar -->
                                    <button *ngIf="isVisibleBotonDetallesDestino"
                                        class="btn btn-secondary mb-3 font-weight-bold"
                                        (click)="toggleVisibility('destino')">
                                        <i class="fas {{ isVisibleDestino ? 'fa-eye-slash' : 'fa-eye' }}"></i>
                                        {{ isVisibleDestino ? 'Ocultar' : 'Mostrar' }} detalles del sitio de destino
                                    </button>
                                    <!-- Datos del sitio -->
                                    <div class="row" *ngIf="isVisibleDestino">
                                        <div class="col">
                                            <div class="card border rounded">
                                                <div class="card-body">
                                                    <table class="table mt-3 table-borderless v-middle custom-table">
                                                        <tbody>
                                                            <tr>
                                                                <td></td>
                                                                <td class="pl-0 text-left">PROPIETARIO:</td>
                                                                <td class="pl-0 text-left font-weight-medium">
                                                                    <p>
                                                                        <span class="pl-0 text-left font-weight-medium">
                                                                            [{{
                                                                            destinoSeleccionado?.numeroIdentificacion
                                                                            }}]
                                                                        </span>
                                                                        <span>&nbsp;&nbsp;</span>
                                                                        <span class="pl-0 text-left font-weight-medium">
                                                                            {{
                                                                            destinoSeleccionado?.nombres.toUpperCase()
                                                                            }}
                                                                        </span>
                                                                    </p>
                                                                </td>
                                                                <td class="pl-0 text-left">PROVINCIA:</td>
                                                                <td class="pl-0 text-left font-weight-medium">{{
                                                                    destinoSeleccionado?.nombreProvinciaSitio.toUpperCase()
                                                                    }}</td>
                                                                <td></td>
                                                            </tr>
                                                            <tr>
                                                                <td></td>
                                                                <td class="pl-0 text-left">CÓDIGO-SITIO:</td>
                                                                <td class="pl-0 text-left font-weight-medium">

                                                                    <p><span
                                                                            class="badge rounded-pill font-weight-bold letra badge-secondary">
                                                                            {{ destinoSeleccionado?.codigoSitio }}
                                                                        </span></p>
                                                                </td>
                                                                <td class="pl-0 text-left">CANTÓN:</td>
                                                                <td class="pl-0 text-left font-weight-medium">{{
                                                                    destinoSeleccionado?.nombreCantonSitio.toUpperCase()
                                                                    }}</td>
                                                                <td></td>
                                                            </tr>
                                                            <tr>
                                                                <td></td>
                                                                <td class="pl-0 text-left">TIPO ÁREA:</td>
                                                                <td class="pl-0 text-left font-weight-medium">{{
                                                                    destinoSeleccionado?.nombreTipoArea.toUpperCase() }}
                                                                </td>
                                                                <td class="pl-0 text-left">PARROQUIA:</td>
                                                                <td class="pl-0 text-left font-weight-medium">{{
                                                                    destinoSeleccionado?.nombreParroquiaSitio.toUpperCase()
                                                                    }}</td>
                                                                <td></td>
                                                            </tr>
                                                            <tr>
                                                                <td></td>
                                                                <td class="pl-0 text-left">NOMBRE-SITIO:</td>
                                                                <td class="pl-0 text-left font-weight-medium">{{
                                                                    destinoSeleccionado?.nombre.toUpperCase() }}</td>
                                                                <td class="pl-0 text-left">DIRECCIÓN:</td>
                                                                <td class="pl-0 text-left font-weight-medium">{{
                                                                    destinoSeleccionado?.callePrincipalSitio.toUpperCase()
                                                                    }}</td>
                                                                <td></td>
                                                            </tr>
                                                            <tr>
                                                                <td></td>
                                                                <td class="pl-0 text-left">COORDENADAS:</td>
                                                                <td class="pl-0 text-left font-weight-medium">
                                                                    LAT [{{ destinoSeleccionado?.latitudSitio }}] - LONG
                                                                    [{{
                                                                    destinoSeleccionado?.longitudSitio }}]
                                                                </td>
                                                                <td class="pl-0 text-left">MAPA:</td>
                                                                <td class="pl-0 text-left font-weight-medium">
                                                                    <button class="styled-button bg-secondary"
                                                                        (click)="abrirGoogleMaps(destinoSeleccionado?.latitudSitio,destinoSeleccionado?.longitudSitio)">
                                                                        <i class="fas fa-map-marker-alt"></i>&nbsp;Ver
                                                                        en
                                                                        Google Maps
                                                                    </button>
                                                                </td>
                                                                <td></td>
                                                            </tr>
                                                        </tbody>
                                                    </table>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </form>
                            </div>
                        </div>
                    </div>
                    <div class="card-body">
                        <div class="form-group row align-items-center" *ngIf="destino !== ''">
                            <label class="col-md-3 text-right control-label col-form-label font-weight-bold">
                                Ruta a seguir (origen &rarr; destino)
                            </label>
                            <div class="col-md-9 border-left pb-2 pt-2">
                                <input class="form-control text-uppercase border-secondary" type="text"
                                    formControlName="ruta" maxlength="256">
                            </div>
                        </div>
                    </div>
                    <hr class="mt-0">
                    <div class="card-body">
                        <h4 class="card-title">Datos del medio de transporte</h4>
                        <div class="form-group row align-items-center">
                            <label class="col-md-3 text-right control-label col-form-label font-weight-bold">
                                Tipo de transporte
                            </label>
                            <div class="col-md-9 border-left pb-2 pt-2">
                                <div class="col" *ngFor="let medio of listaMediosTransportes">
                                    <input (change)="cambioMedioTransporte(medio.idMedioTransporte)"
                                        formControlName="medio_transporte" name="medio_transporte" type="radio"
                                        id="{{medio.codigo}}" [value]="medio.idMedioTransporte"
                                        class="material-inputs radio-col-red">
                                    <label class="font-weight-bold" for="{{medio.codigo}}">{{ medio.nombre}}</label>
                                </div>
                                <div class="invalid-feedback d-block font-weight-bold"
                                    *ngIf="formulario.controls['medio_transporte'].status==='INVALID' && formulario.touched">
                                    Seleccione el tipo de transporte que se usará.
                                </div>
                            </div>
                        </div>
                        <div *ngIf="medioTransporteSeleccionado==='vehiculo'">
                            <div class="form-group row align-items-baseline mb-0">
                                <label class="col-md-3 text-right control-label col-form-label font-weight-bold">
                                    Placa
                                </label>
                                <div class="col-md-9 border-left pb-2 pt-2 input-group">
                                    <input type="text" style="width: 25%; min-width: 0; flex: 0 0 25%;"
                                        class="form-control border-secondary text-uppercase"
                                        (keydown.enter)="buscarTransporte(placa.value)"
                                        (input)="limpiarDetalleVehiculo()" #placa maxlength="25"
                                        placeholder="EJEMPLO: MNA0123">
                                    <div class="input-group-append">
                                        <button type="button" class="btn btn-info border-secondary font-weight-bold"
                                            (click)="buscarTransporte(placa.value)">
                                            <i class="fas fa-search"></i> Buscar
                                        </button>
                                    </div>
                                </div>
                                <label class="col-md-3 text-right control-label col-form-label font-weight-bold">
                                    Detalle del vehículo
                                </label>
                                <div class="col-md-9 border-left pb-2 pt-2 input-group">
                                    <input type="text" class="form-control border-secondary"
                                        formControlName="inputDetalleVehiculo" placeholder="ingrese datos del vehículo"
                                        readonly>
                                    <div class="invalid-feedback d-block font-weight-bold" *ngIf="(formulario.get('placa').errors?.placaObligatoria || formulario.get('inputDetalleVehiculo').errors?.placaObligatoria) && 
                                               formulario.get('placa').touched">
                                        Ingrese datos del vehículo que transportará los animales.
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <hr *ngIf="medioTransporteSeleccionado==='vehiculo'" class="mt-0">
                    <h4 *ngIf="medioTransporteSeleccionado==='vehiculo'" class="card-title">Datos del transportista</h4>
                    <div *ngIf="medioTransporteSeleccionado==='vehiculo'" class="card-body">
                        <div class="form-group row align-items-baseline mb-0">
                            <label class="col-md-3 text-right control-label col-form-label font-weight-bold">
                                Número de identificación
                            </label>
                            <div class="col-md-9 border-left pb-2 pt-2 input-group">
                                <input type="text" style="width: 25%; min-width: 0; flex: 0 0 25%;"
                                    class="form-control border-secondary"
                                    (keydown.enter)="buscarTransportista(cedula.value)"
                                    (input)="limpiarDatosTransportista()" placeholder="Ingrese # de identificación"
                                    #cedula maxlength="25">
                                <div class="input-group-append">
                                    <button type="button" class="btn btn-info border-secondary font-weight-bold"
                                        (click)="buscarTransportista(cedula.value)">
                                        <i class="fas fa-search"></i> Buscar
                                    </button>
                                </div>

                            </div>
                            <label class="col-md-3 text-right control-label col-form-label font-weight-bold">
                                Nombres y apellidos
                            </label>
                            <div class="col-md-9 border-left pb-2 pt-2 input-group">
                                <input type="text" class="form-control border-secondary"
                                    formControlName="inputDatosTransportista"
                                    placeholder="ingrese datos del transportista" readonly>
                                <div class="invalid-feedback d-block font-weight-bold" *ngIf="(formulario.get('id_transportista').errors?.transportistaObligatorio || 
                                           formulario.get('inputDatosTransportista').errors?.transportistaObligatorio) &&
                                           formulario.get('id_transportista').touched">
                                    Ingrese datos del transportista.
                                </div>
                            </div>
                        </div>
                    </div>
                    <hr class="mt-0">
                    <div class="card-body">
                        <h4 class="card-title">Inicio y fin de validez del documento</h4>
                        <div class="form-group row align-items-center mb-0">
                            <label class="col-md-3 text-right control-label col-form-label font-weight-bold">
                                Trayecto (origen &rarr; destino)
                            </label>
                            <div class="col-md-9 border-left pb-2 pt-2">
                                <span class="invoice-number ml-2" [innerHTML]="msjTrayecto"></span>
                            </div>
                            <label class="col-md-3 text-right control-label col-form-label font-weight-bold">
                                Fecha de movilización
                            </label>
                            <div class="col-md-3 border-left pb-2 pt-2 input-group">
                                <input style="width: 400px;" lang="es" type='date' class="form-control border-secondary"
                                    [min]="fechaMinima | date: 'yyyy-MM-dd'" [max]="fechaMaxima | date: 'yyyy-MM-dd'"
                                    formControlName="fecha_hora_movilizacion"
                                    (change)="cambioFechaHoraMovilizacion()" />
                                <div class="invalid-feedback d-block font-weight-bold"
                                    *ngIf="formulario.controls.fecha_hora_movilizacion.errors?.required && formulario.touched">
                                    Ingrese la fecha movilización.
                                </div>
                                <div class="invalid-feedback d-block font-weight-bold"
                                    *ngIf="formulario.errors?.fechaMayorPermitida && formulario.touched">
                                    La fecha no puede ser mayor a 3 (tres) días
                                </div>
                            </div>
                        </div>
                        <div class="form-group row align-items-center mb-0">
                            <label class="col-md-3 text-right control-label col-form-label font-weight-bold">
                                Hora de movilización
                            </label>
                            <div class="col-md-3 border-left pb-2 pt-2 input-group">
                                <input lang="es" type='time' class="form-control border-secondary" min="05:00"
                                    max="18:00" formControlName="hora_movilizacion"
                                    (change)="cambioFechaHoraMovilizacion()">
                                <span
                                    style="background-color:chartreuse; color:black; font-weight:bold; text-align: center; padding: 5px; border-radius: 5px;">24
                                    horas</span>
                                <div class="invalid-feedback d-block font-weight-bold"
                                    *ngIf="formulario.controls.hora_movilizacion.errors?.required && formulario.touched">
                                    Ingrese la hora de movilización.
                                </div>
                                <div class="invalid-feedback d-block font-weight-bold"
                                    *ngIf="formulario.errors?.fechaRangoNoPermitido && formulario.touched">
                                    Movilización permitida de 05H00 a 18H00.
                                </div>
                                <div class="invalid-feedback d-block font-weight-bold"
                                    *ngIf="formulario.errors?.fechaMenorActual && formulario.touched">
                                    La fecha y hora seleccionada debe ser mayor a la fecha y hora actual.
                                </div>
                            </div>
                        </div>
                        <div class="form-group row align-items-center mb-0">
                            <label class="col-md-3 text-right control-label col-form-label font-weight-bold">
                                Tiempo de validez
                            </label>
                            <div class="col-md-3 border-left pb-2 pt-2 input-group">
                                <select formControlName="horas" class="form-control border-secondary">
                                    <option *ngFor="let valor of listaHoras" [value]="valor">{{ valor }}</option>
                                </select>
                                <span
                                    style="background-color:chartreuse; color:black; font-weight:bold; text-align: center; padding: 5px; border-radius: 5px;">horas</span>
                                <select formControlName="minutos" class="form-control border-secondary">
                                    <option *ngFor="let valor of listaMinutos" [value]="valor">{{ valor }}</option>
                                </select>
                                <span
                                    style="background-color:chartreuse; color:black; font-weight:bold; text-align: center; padding: 5px; border-radius: 5px;">minutos</span>
                                <div class="invalid-feedback d-block font-weight-bold"
                                    *ngIf="formulario.touched && formulario.errors?.tiempoValidezRequerido">
                                    Ingrese el tiempo de validez
                                </div>
                                <div class="invalid-feedback d-block font-weight-bold"
                                    *ngIf="formulario.touched && formulario.errors?.tiempoValidezValorMinimo">
                                    El tiempo de validez debe ser mínimo 5 minutos
                                </div>
                                <!-- Mensaje de error si el tiempo es insuficiente -->
                                <div class="invalid-feedback d-block font-weight-bold"
                                    *ngIf="formulario.touched && formulario.errors?.tiempoRecorridoInsuficiente">
                                    Tiempo de validez mínimo: <b>{{ tiempoMinimoHoras }} horas {{ tiempoMinimoMinutos }}
                                        minutos</b>.
                                </div>
                            </div>
                        </div>
                    </div>
                    <hr class="mt-0">
                    <!--------------------------------------------------------------------------------------------------------------------------->
                    <div class="card-body">
                        <div class="form-group mb-0 text-center">
                            <button class="btn btn-info btn-lg font-weight-bold font-16 text-uppercase mx-2"
                                style="width: 48%;" type="submit">Generar CZPM-M
                            </button>
                            <button class="btn btn-danger btn-lg font-weight-bold font-16 text-uppercase mx-2"
                                style="width: 48%;" type="button" (click)="botonCancelar()">Cancelar</button>
                        </div>
                    </div>

                </form>
            </div>
        </div>
    </div>
</div>